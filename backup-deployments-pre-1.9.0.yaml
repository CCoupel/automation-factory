apiVersion: v1
items:
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "66"
      field.cattle.io/publicEndpoints: "null"
      meta.helm.sh/release-name: ansible-builder
      meta.helm.sh/release-namespace: ansible-builder
    creationTimestamp: "2025-12-04T17:12:54Z"
    generation: 76
    labels:
      app.kubernetes.io/component: backend
      app.kubernetes.io/instance: ansible-builder
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: ansible-builder
      app.kubernetes.io/version: 1.3.7
      helm.sh/chart: ansible-builder-1.3.7
    name: ansible-builder-backend
    namespace: ansible-builder
    resourceVersion: "17544912"
    uid: ba24bbb9-56c8-44ac-9e33-108af63173bd
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/component: backend
        app.kubernetes.io/instance: ansible-builder
        app.kubernetes.io/name: ansible-builder
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          cattle.io/timestamp: "2025-12-05T12:55:08Z"
          checksum/config: f339bb28c1859a96c509e99aa09a3b71cadba74522826417fa3ed192b222cb9c
          checksum/secret: 37cda51d77ac96d1ff7c08041bd27d5231bbf55d40fa56ccbcd16a897379ef69
          kubectl.kubernetes.io/restartedAt: "2025-12-12T15:51:00+01:00"
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: backend
          app.kubernetes.io/instance: ansible-builder
          app.kubernetes.io/name: ansible-builder
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/name
                    operator: In
                    values:
                    - ansible-builder
                topologyKey: kubernetes.io/hostname
              weight: 100
        containers:
        - env:
          - name: DATABASE_TYPE
            value: sqlite
          - name: POSTGRES_HOST
            value: external-postgres.example.com
          - name: POSTGRES_PORT
            value: "5432"
          - name: POSTGRES_DB
            value: ansible_builder
          - name: POSTGRES_USER
            value: ansible
          - name: POSTGRES_PASSWORD
            valueFrom:
              secretKeyRef:
                key: postgres-password
                name: ansible-builder-backend
          - name: REDIS_HOST
            value: ansible-builder-redis-master
          - name: REDIS_PORT
            value: "6379"
          - name: REDIS_PASSWORD
            valueFrom:
              secretKeyRef:
                key: redis-password
                name: ansible-builder-backend
          - name: JWT_SECRET_KEY
            valueFrom:
              secretKeyRef:
                key: jwt-secret-key
                name: ansible-builder-backend
          - name: JWT_ALGORITHM
            value: HS256
          - name: JWT_ACCESS_TOKEN_EXPIRE_MINUTES
            value: "1440"
          - name: CORS_ORIGINS
            valueFrom:
              configMapKeyRef:
                key: cors-origins
                name: ansible-builder-backend
          image: ghcr.io/ccoupel/ansible-builder-backend:1.8.1
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 8000
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
          name: backend
          ports:
          - containerPort: 8000
            name: http
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /health
              port: 8000
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              cpu: "1"
              memory: 1Gi
            requests:
              cpu: 500m
              memory: 512Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: false
            runAsNonRoot: true
            runAsUser: 1000
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          fsGroup: 1000
          runAsNonRoot: true
          runAsUser: 1000
        serviceAccount: ansible-builder
        serviceAccountName: ansible-builder
        terminationGracePeriodSeconds: 30
  status:
    availableReplicas: 1
    conditions:
    - lastTransitionTime: "2025-12-05T14:08:10Z"
      lastUpdateTime: "2025-12-05T14:08:10Z"
      message: Deployment has minimum availability.
      reason: MinimumReplicasAvailable
      status: "True"
      type: Available
    - lastTransitionTime: "2025-12-06T14:48:05Z"
      lastUpdateTime: "2025-12-12T15:59:22Z"
      message: ReplicaSet "ansible-builder-backend-bfc78bdfd" has successfully progressed.
      reason: NewReplicaSetAvailable
      status: "True"
      type: Progressing
    observedGeneration: 76
    readyReplicas: 1
    replicas: 1
    updatedReplicas: 1
- apiVersion: apps/v1
  kind: Deployment
  metadata:
    annotations:
      deployment.kubernetes.io/revision: "60"
      field.cattle.io/publicEndpoints: '[{"addresses":["192.168.1.150"],"port":443,"protocol":"HTTPS","serviceName":"ansible-builder:ansible-builder-frontend","ingressName":"ansible-builder:ansible-builder","hostname":"coupel.net","path":"/ansible-builder","allNodes":false}]'
      meta.helm.sh/release-name: ansible-builder
      meta.helm.sh/release-namespace: ansible-builder
    creationTimestamp: "2025-12-04T17:12:54Z"
    generation: 65
    labels:
      app.kubernetes.io/component: frontend
      app.kubernetes.io/instance: ansible-builder
      app.kubernetes.io/managed-by: Helm
      app.kubernetes.io/name: ansible-builder
      app.kubernetes.io/version: 1.3.7
      helm.sh/chart: ansible-builder-1.3.7
    name: ansible-builder-frontend
    namespace: ansible-builder
    resourceVersion: "18411403"
    uid: 9306f766-9902-42c7-8c41-5e941ac395ea
  spec:
    progressDeadlineSeconds: 600
    replicas: 1
    revisionHistoryLimit: 10
    selector:
      matchLabels:
        app.kubernetes.io/component: frontend
        app.kubernetes.io/instance: ansible-builder
        app.kubernetes.io/name: ansible-builder
    strategy:
      rollingUpdate:
        maxSurge: 25%
        maxUnavailable: 25%
      type: RollingUpdate
    template:
      metadata:
        annotations:
          checksum/config: d682d073864199abff448cf2673b7d7031025ad6da60450db4df6b258ab1ac43
          kubectl.kubernetes.io/restartedAt: "2025-12-12T17:08:53+01:00"
        creationTimestamp: null
        labels:
          app.kubernetes.io/component: frontend
          app.kubernetes.io/instance: ansible-builder
          app.kubernetes.io/name: ansible-builder
      spec:
        affinity:
          podAntiAffinity:
            preferredDuringSchedulingIgnoredDuringExecution:
            - podAffinityTerm:
                labelSelector:
                  matchExpressions:
                  - key: app.kubernetes.io/name
                    operator: In
                    values:
                    - ansible-builder
                topologyKey: kubernetes.io/hostname
              weight: 100
        containers:
        - env:
          - name: BASE_PATH
            value: /ansible-builder
          image: ghcr.io/ccoupel/ansible-builder-frontend:1.8.1
          imagePullPolicy: Always
          livenessProbe:
            failureThreshold: 3
            httpGet:
              path: /
              port: 80
              scheme: HTTP
            initialDelaySeconds: 30
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 5
          name: frontend
          ports:
          - containerPort: 80
            name: http
            protocol: TCP
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /
              port: 80
              scheme: HTTP
            initialDelaySeconds: 10
            periodSeconds: 5
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              cpu: 500m
              memory: 512Mi
            requests:
              cpu: 250m
              memory: 256Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            readOnlyRootFilesystem: false
            runAsNonRoot: true
            runAsUser: 1000
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext:
          fsGroup: 1000
          runAsNonRoot: true
          runAsUser: 1000
        serviceAccount: ansible-builder
        serviceAccountName: ansible-builder
        terminationGracePeriodSeconds: 30
  status:
    availableReplicas: 1
    conditions:
    - lastTransitionTime: "2025-12-06T14:48:05Z"
      lastUpdateTime: "2025-12-12T16:09:06Z"
      message: ReplicaSet "ansible-builder-frontend-548cc84bd4" has successfully progressed.
      reason: NewReplicaSetAvailable
      status: "True"
      type: Progressing
    - lastTransitionTime: "2025-12-14T09:19:01Z"
      lastUpdateTime: "2025-12-14T09:19:01Z"
      message: Deployment has minimum availability.
      reason: MinimumReplicasAvailable
      status: "True"
      type: Available
    observedGeneration: 65
    readyReplicas: 1
    replicas: 1
    updatedReplicas: 1
kind: List
metadata:
  resourceVersion: ""
