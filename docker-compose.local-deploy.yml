version: '3.8'

# This file will be auto-generated by dev-deploy.ps1
# Template for local development deployment

services:
  # Backend service
  backend:
    image: ansible-builder-backend:latest
    container_name: ansible-builder-backend-local
    ports:
      - "8000:8000"
    environment:
      - DATABASE_TYPE=sqlite
      - SQLITE_DB_PATH=/tmp/ansible_builder.db
      - DEBUG=true
      - PYTHONPATH=/app
      - JWT_SECRET_KEY=dev-secret-key-change-in-production
    restart: unless-stopped
    networks:
      - local-network
    healthcheck:
      test: ["CMD", "python", "-c", "import httpx; httpx.get('http://localhost:8000/api/health', timeout=5)"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  # Frontend service  
  frontend:
    image: ansible-builder-frontend:latest
    container_name: ansible-builder-frontend-local
    ports:
      - "5173:80"
    environment:
      - API_BASE_URL=http://localhost:8000
      - BASE_PATH=/
    restart: unless-stopped
    networks:
      - local-network
    depends_on:
      backend:
        condition: service_healthy

networks:
  local-network:
    driver: bridge